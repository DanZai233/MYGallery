# MYGallery - ä¸ªäººç…§ç‰‡å¢™ç³»ç»Ÿ

<div align="center">
  <h1>ğŸ“· MYGallery</h1>
  <p>ä¸€ä¸ªç®€çº¦ã€ç¾è§‚ã€åŠŸèƒ½å®Œæ•´çš„ä¸ªäººç…§ç‰‡å¢™ç³»ç»Ÿ</p>
  <p>äººäººéƒ½å¯ä»¥è‡ªéƒ¨ç½²è‡ªå·±çš„ç…§ç‰‡å±•ç¤ºç©ºé—´</p>
  
  <p>
    <img src="https://img.shields.io/badge/Version-1.1.4-blue" alt="Version">
    <img src="https://img.shields.io/badge/Go-1.24+-00ADD8?style=flat&logo=go" alt="Go Version">
    <img src="https://img.shields.io/badge/License-MIT-green.svg" alt="License">
  </p>
</div>

---

## âœ¨ ç‰¹æ€§

### ğŸ¨ ç²¾ç¾çš„å‰ç«¯å±•ç¤º
- **ç€‘å¸ƒæµå¸ƒå±€**ï¼šå“åº”å¼è®¾è®¡ï¼Œè‡ªé€‚åº”å„ç§å±å¹•å°ºå¯¸ï¼ˆ4/3/2 åˆ—è‡ªåŠ¨åˆ‡æ¢ï¼‰
- **ç¯ç®±æ•ˆæœ**ï¼šç‚¹å‡»æŸ¥çœ‹å¤§å›¾ï¼Œæ”¯æŒé”®ç›˜å¯¼èˆªå’Œç¼©æ”¾
- **æ¯›ç»ç’ƒè´¨æ„Ÿ**ï¼šç°ä»£åŒ– Glassmorphism UI è®¾è®¡
- **EXIF å…ƒæ•°æ®å±•ç¤º**ï¼šè‡ªåŠ¨æ˜¾ç¤ºç›¸æœº/æ‰‹æœºå‹å·ã€æ‹æ‘„å‚æ•°ã€ä½ç½®ç­‰ä¿¡æ¯
- **åˆ†ç±»ç­›é€‰**ï¼šæŒ‰åˆ†ç±»å¿«é€Ÿç­›é€‰ç…§ç‰‡ï¼Œç§»åŠ¨ç«¯æ”¯æŒæ¨ªå‘æ»‘åŠ¨
- **æœç´¢åŠŸèƒ½**ï¼šæ”¯æŒæœç´¢æ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾ã€ä½ç½®ç­‰
- **é»‘å¤œæ¨¡å¼**ï¼šä¸€é”®åˆ‡æ¢ç™½å¤©/é»‘å¤œä¸»é¢˜ï¼Œè®°å¿†ç”¨æˆ·åå¥½
- **Live Photo æ”¯æŒ**ï¼šæ”¯æŒ Apple Live Photo æ ‡è¯†å±•ç¤º

### ğŸ“± ç§»åŠ¨ç«¯å‹å¥½
- **å“åº”å¼å¯¼èˆª**ï¼šç§»åŠ¨ç«¯è‡ªåŠ¨åˆ‡æ¢ä¸ºæ±‰å ¡èœå•
- **è§¦æ‘¸å‹å¥½**ï¼šç…§ç‰‡å¡ç‰‡æ”¯æŒè§¦æ‘¸äº¤äº’ï¼Œé•¿æŒ‰æ˜¾ç¤ºè¯¦æƒ…
- **æ¨ªå‘æ»‘åŠ¨åˆ†ç±»**ï¼šåˆ†ç±»è¿‡å¤šæ—¶è‡ªåŠ¨æ”¯æŒæ¨ªå‘æ»šåŠ¨
- **æ»šåŠ¨å›é¡¶**ï¼šä¸€é”®å›åˆ°é¡¶éƒ¨æŒ‰é’®
- **PWA ä¼˜åŒ–**ï¼šæ”¯æŒæ·»åŠ åˆ°ä¸»å±å¹•

### âš™ï¸ å¼ºå¤§çš„åå°ç®¡ç†
- **ç”¨æˆ·ç™»å½•éªŒè¯**ï¼šJWT token è®¤è¯ï¼Œå®‰å…¨å¯é 
- **å›¾ç‰‡ä¸Šä¼ **ï¼šæ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œæ‰¹é‡ä¸Šä¼ ï¼Œå®æ—¶è¿›åº¦æ˜¾ç¤º
- **EXIF è‡ªåŠ¨æå–**ï¼šè‡ªåŠ¨è¯»å–ç…§ç‰‡çš„ç›¸æœºå‚æ•°ã€GPS ä½ç½®ç­‰å…ƒæ•°æ®
- **å¢å¼º EXIF è§£æ**ï¼šæ”¯æŒç›¸æœºå’Œæ‰‹æœºæ‹æ‘„çš„ç…§ç‰‡ï¼Œæå–æ›´å¤šå…ƒæ•°æ®å­—æ®µ
- **Live Photo ä¸Šä¼ **ï¼šæ”¯æŒåŒæ—¶ä¸Šä¼ ç…§ç‰‡å’Œé…å¥—è§†é¢‘
- **åˆ†ç±»ç®¡ç†**ï¼šåˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤ç…§ç‰‡åˆ†ç±»
- **ç½‘ç«™è®¾ç½®**ï¼šè‡ªå®šä¹‰ç½‘ç«™ä¿¡æ¯ã€å¤‡æ¡ˆä¿¡æ¯ã€Header/Footer ç­‰

### ğŸ”§ çµæ´»çš„é…ç½®ç³»ç»Ÿ
- **å¤šæ•°æ®åº“æ”¯æŒ**ï¼šSQLiteï¼ˆé»˜è®¤ï¼‰ã€MySQLã€PostgreSQL
- **å¤šå­˜å‚¨æ”¯æŒ**ï¼šæœ¬åœ°å­˜å‚¨ï¼ˆé»˜è®¤ï¼‰ã€AWS S3ã€MinIOã€é˜¿é‡Œäº‘ OSS
- **äº‘å­˜å‚¨ç¼©ç•¥å›¾**ï¼šæ‰€æœ‰å­˜å‚¨åç«¯å‡æ”¯æŒè‡ªåŠ¨ç”Ÿæˆå’Œä¸Šä¼ ç¼©ç•¥å›¾
- **YAML é…ç½®**ï¼šç®€å•ç›´è§‚çš„é…ç½®æ–‡ä»¶
- **Docker éƒ¨ç½²**ï¼šä¸€é”®éƒ¨ç½²ï¼Œå¼€ç®±å³ç”¨

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Go 1.24+**ï¼ˆéœ€è¦ CGO æ”¯æŒï¼Œç”¨äº SQLiteï¼‰
- **GCC**ï¼ˆC ç¼–è¯‘å™¨ï¼ŒSQLite é©±åŠ¨éœ€è¦ï¼‰
- **Git**

### æœ¬åœ°è¿è¡Œï¼ˆæ¨èå¼€å‘ä½¿ç”¨ï¼‰

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/danzai233/mygallery.git
cd mygallery

# 2. å®‰è£… Go ä¾èµ–
go mod download

# 3. åˆ›å»ºé…ç½®æ–‡ä»¶
cp config.example.yaml config.yaml

# 4. åˆå§‹åŒ–é¡¹ç›®ç›®å½•
make init

# 5. è¿è¡Œåº”ç”¨
go run main.go
```

è®¿é—®åº”ç”¨ï¼š
- ğŸ“· **å‰å°å±•ç¤º**ï¼šhttp://localhost:8080
- âš™ï¸ **åå°ç®¡ç†**ï¼šhttp://localhost:8080/admin
- ğŸ‘¤ **é»˜è®¤è´¦å·**ï¼š`admin` / `admin123`

> âš ï¸ **é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼**

### Docker éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ä½¿ç”¨ï¼‰

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/danzai233/mygallery.git
cd mygallery

# 2. åˆ›å»ºé…ç½®
cp config.example.yaml config.yaml
# ç¼–è¾‘ config.yamlï¼Œä¿®æ”¹ç®¡ç†å‘˜å¯†ç å’Œ JWT å¯†é’¥

# 3. æ„å»ºå¹¶å¯åŠ¨
docker compose build
docker compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker compose logs -f

# åœæ­¢æœåŠ¡
docker compose down
```

### ä½¿ç”¨ Makefile

```bash
make help       # æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make init       # åˆå§‹åŒ–é¡¹ç›®ï¼ˆåˆ›å»ºé…ç½®æ–‡ä»¶å’Œç›®å½•ï¼‰
make deps       # å®‰è£…ä¾èµ–
make build      # ç¼–è¯‘äºŒè¿›åˆ¶
make run        # è¿è¡Œåº”ç”¨
make dev        # å¼€å‘æ¨¡å¼ï¼ˆéœ€å®‰è£… air çƒ­é‡è½½ï¼‰
make test       # è¿è¡Œæµ‹è¯•
make clean      # æ¸…ç†æ„å»ºæ–‡ä»¶
```

---

## ğŸ”§ é…ç½®è¯¦è§£

é…ç½®æ–‡ä»¶ä¸ºé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `config.yaml`ï¼Œä» `config.example.yaml` å¤åˆ¶ä¿®æ”¹ã€‚

### æœåŠ¡å™¨é…ç½®

```yaml
server:
  host: "0.0.0.0"
  port: 8080
  mode: "release"  # debug(å¼€å‘), release(ç”Ÿäº§), test(æµ‹è¯•)
```

### æ•°æ®åº“é…ç½®

æ”¯æŒä¸‰ç§æ•°æ®åº“ï¼Œé€šè¿‡ `database.type` åˆ‡æ¢ï¼š

#### SQLiteï¼ˆé»˜è®¤ï¼Œé›¶é…ç½®ï¼‰

```yaml
database:
  type: "sqlite"
  sqlite:
    path: "./data/mygallery.db"
```

#### MySQL

```yaml
database:
  type: "mysql"
  mysql:
    host: "localhost"
    port: 3306
    username: "root"
    password: "your-password"
    database: "mygallery"
    charset: "utf8mb4"
```

#### PostgreSQL

```yaml
database:
  type: "postgres"
  postgres:
    host: "localhost"
    port: 5432
    username: "postgres"
    password: "your-password"
    database: "mygallery"
    sslmode: "disable"
```

### å­˜å‚¨é…ç½®

æ”¯æŒå››ç§å­˜å‚¨åç«¯ï¼Œé€šè¿‡ `storage.type` åˆ‡æ¢ã€‚æ‰€æœ‰åç«¯å‡æ”¯æŒè‡ªåŠ¨ç¼©ç•¥å›¾ç”Ÿæˆã€‚

#### æœ¬åœ°å­˜å‚¨ï¼ˆé»˜è®¤ï¼‰

```yaml
storage:
  type: "local"
  local:
    upload_dir: "./uploads"
    thumbnail_dir: "./uploads/thumbnails"
    url_prefix: "/uploads"
```

#### AWS S3

```yaml
storage:
  type: "s3"
  s3:
    region: "us-east-1"
    bucket: "mygallery"
    access_key: "YOUR_ACCESS_KEY"
    secret_key: "YOUR_SECRET_KEY"
    endpoint: ""              # ç•™ç©ºä½¿ç”¨ AWS é»˜è®¤ï¼Œæˆ–è‡ªå®šä¹‰
    url_prefix: "https://your-bucket.s3.amazonaws.com"
```

#### MinIOï¼ˆS3 å…¼å®¹çš„è‡ªå»ºå¯¹è±¡å­˜å‚¨ï¼‰

```yaml
storage:
  type: "minio"
  minio:
    endpoint: "localhost:9000"
    bucket: "mygallery"
    access_key: "minioadmin"
    secret_key: "minioadmin"
    use_ssl: false
    url_prefix: "http://localhost:9000/mygallery"
```

#### é˜¿é‡Œäº‘ OSS

```yaml
storage:
  type: "aliyun"
  aliyun:
    endpoint: "oss-cn-hangzhou.aliyuncs.com"
    bucket: "mygallery"
    access_key: "YOUR_ACCESS_KEY"
    secret_key: "YOUR_SECRET_KEY"
    url_prefix: "https://mygallery.oss-cn-hangzhou.aliyuncs.com"
```

### JWT ä¸ç®¡ç†å‘˜é…ç½®

```yaml
jwt:
  secret: "change-this-to-a-random-string"  # ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ï¼
  expire_hours: 168  # Token æœ‰æ•ˆæœŸï¼ˆ7å¤©ï¼‰

admin:
  username: "admin"
  password: "admin123"  # é¦–æ¬¡å¯åŠ¨åè‡ªåŠ¨åŠ å¯†
  email: "admin@example.com"
```

### å›¾ç‰‡å¤„ç†é…ç½®

```yaml
image:
  max_upload_size: 52428800  # 50MB
  allowed_types:
    - "image/jpeg"
    - "image/png"
    - "image/gif"
    - "image/webp"
  thumbnail:
    width: 400
    height: 400
    quality: 85
```

---

## ğŸ“¸ EXIF å…ƒæ•°æ®æ”¯æŒ

MYGallery è‡ªåŠ¨ä»ä¸Šä¼ çš„ç…§ç‰‡ä¸­æå– EXIF å…ƒæ•°æ®ï¼Œå…¼å®¹ç›¸æœºå’Œæ‰‹æœºæ‹æ‘„çš„ç…§ç‰‡ï¼š

| å­—æ®µ | è¯´æ˜ | ç›¸æœº | iPhone | Android |
|------|------|:----:|:------:|:-------:|
| ç›¸æœºå“ç‰Œ | Camera Make | âœ… | âœ… | âœ… |
| ç›¸æœºå‹å· | Camera Model | âœ… | âœ… | âœ… |
| é•œå¤´å‹å· | Lens Model | âœ… | âœ… | éƒ¨åˆ† |
| ç„¦è· | Focal Length | âœ… | âœ… | âœ… |
| å…‰åœˆ | F-Number | âœ… | âœ… | âœ… |
| å¿«é—¨é€Ÿåº¦ | Exposure Time | âœ… | âœ… | âœ… |
| ISO | ISO Speed | âœ… | âœ… | âœ… |
| æ‹æ‘„æ—¶é—´ | Date Taken | âœ… | âœ… | âœ… |
| GPS ä½ç½® | GPS Coordinates | âœ… | âœ… | âœ… |
| æ‹æ‘„è½¯ä»¶ | Software | âœ… | âœ… | âœ… |
| å›¾ç‰‡æ–¹å‘ | Orientation | âœ… | âœ… | âœ… |
| ç™½å¹³è¡¡ | White Balance | âœ… | âœ… | âœ… |
| é—ªå…‰ç¯ | Flash | âœ… | âœ… | âœ… |
| æ›å…‰æ¨¡å¼ | Exposure Program | âœ… | âœ… | éƒ¨åˆ† |
| æµ‹å…‰æ¨¡å¼ | Metering Mode | âœ… | âœ… | âœ… |
| æ›å…‰è¡¥å¿ | Exposure Bias | âœ… | âœ… | âœ… |
| è‰²å½©ç©ºé—´ | Color Space | âœ… | âœ… | âœ… |

> ç¼©ç•¥å›¾ç”Ÿæˆæ—¶ä¼šè‡ªåŠ¨æ ¹æ® EXIF æ–¹å‘æ ‡è®°æ—‹è½¬å›¾ç‰‡ï¼Œç¡®ä¿æ˜¾ç¤ºæ–¹å‘æ­£ç¡®ã€‚

---

## ğŸ¬ Live Photo æ”¯æŒ

MYGallery æ”¯æŒ Apple Live Photo çš„ä¸Šä¼ å’Œå±•ç¤ºï¼š

- **ä¸Šä¼ **ï¼šåœ¨åå°ä¸Šä¼ ç…§ç‰‡æ—¶ï¼Œå¯åŒæ—¶ä¸Šä¼ é…å¥—çš„ `.mov` è§†é¢‘æ–‡ä»¶
- **å±•ç¤º**ï¼šå‰ç«¯ç…§ç‰‡å¡ç‰‡å·¦ä¸Šè§’æ˜¾ç¤º `LIVE` å¾½ç« 
- **API**ï¼šé€šè¿‡ `POST /api/photos` çš„ `live_photo` å­—æ®µä¸Šä¼ è§†é¢‘

```bash
# ä¸Šä¼  Live Photo ç¤ºä¾‹
curl -X POST http://localhost:8080/api/photos \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "photo=@IMG_1234.jpg" \
  -F "live_photo=@IMG_1234.mov" \
  -F "title=æˆ‘çš„ Live Photo"
```

---

## ğŸŒ API æ¥å£

### å…¬å¼€æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/photos` | è·å–ç…§ç‰‡åˆ—è¡¨ï¼ˆæ”¯æŒ `page`ã€`size`ã€`category`ã€`search` å‚æ•°ï¼‰ |
| GET | `/api/photos/:id` | è·å–å•å¼ ç…§ç‰‡è¯¦æƒ… |
| GET | `/api/categories` | è·å–åˆ†ç±»åˆ—è¡¨ |
| GET | `/api/settings` | è·å–ç½‘ç«™è®¾ç½® |
| GET | `/health` | å¥åº·æ£€æŸ¥ |

### éœ€è®¤è¯æ¥å£ï¼ˆéœ€è¦ `Authorization: Bearer <token>` å¤´ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| POST | `/api/auth/login` | ç®¡ç†å‘˜ç™»å½• |
| POST | `/api/auth/change-password` | ä¿®æ”¹å¯†ç  |
| POST | `/api/photos` | ä¸Šä¼ ç…§ç‰‡ï¼ˆæ”¯æŒ Live Photoï¼‰ |
| PUT | `/api/photos/:id` | æ›´æ–°ç…§ç‰‡ä¿¡æ¯ |
| DELETE | `/api/photos/:id` | åˆ é™¤ç…§ç‰‡ |
| POST | `/api/categories` | åˆ›å»ºåˆ†ç±» |
| PUT | `/api/categories/:id` | æ›´æ–°åˆ†ç±» |
| DELETE | `/api/categories/:id` | åˆ é™¤åˆ†ç±» |
| PUT | `/api/settings` | æ›´æ–°ç½‘ç«™è®¾ç½® |

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### æ–¹å¼ä¸€ï¼šç›´æ¥è¿è¡ŒäºŒè¿›åˆ¶

```bash
# ç¼–è¯‘
go build -o mygallery main.go

# åˆ›å»ºé…ç½®
cp config.example.yaml config.yaml
# ç¼–è¾‘ config.yaml

# åˆ›å»ºç›®å½•
mkdir -p data uploads uploads/thumbnails

# è¿è¡Œ
./mygallery
```

### æ–¹å¼äºŒï¼šDocker Composeï¼ˆæ¨èï¼‰

```bash
cp config.example.yaml config.yaml
docker compose build
docker compose up -d
```

### æ–¹å¼ä¸‰ï¼šNginx åå‘ä»£ç†

```nginx
server {
    listen 80;
    server_name gallery.example.com;
    client_max_body_size 50M;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### æ–¹å¼å››ï¼šSystemd æœåŠ¡

```ini
# /etc/systemd/system/mygallery.service
[Unit]
Description=MYGallery Photo Gallery
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/opt/mygallery
ExecStart=/opt/mygallery/mygallery
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable mygallery
sudo systemctl start mygallery
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤å¯†ç ** â€” é¦–æ¬¡ç™»å½•åç«‹å³ä¿®æ”¹
2. **ä¿®æ”¹ JWT å¯†é’¥** â€” `config.yaml` ä¸­çš„ `jwt.secret`
3. **å¯ç”¨ HTTPS** â€” ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Nginx + Let's Encrypt
4. **é…ç½®é˜²ç«å¢™** â€” åªå¼€æ”¾å¿…è¦ç«¯å£
5. **å®šæœŸå¤‡ä»½æ•°æ®** â€” å¤‡ä»½ `data/` å’Œ `uploads/` ç›®å½•

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ |
|------|------|
| åç«¯æ¡†æ¶ | Go + Gin |
| ORM | GORM |
| è®¤è¯ | JWT (golang-jwt) |
| EXIF è§£æ | rwcarlsen/goexif |
| å›¾ç‰‡å¤„ç† | disintegration/imaging |
| æ•°æ®åº“ | SQLite / MySQL / PostgreSQL |
| å¯¹è±¡å­˜å‚¨ | Local / AWS S3 / MinIO / é˜¿é‡Œäº‘ OSS |
| å‰ç«¯ | åŸç”Ÿ JavaScript + Tailwind CSS + lightGallery |

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

<div align="center">
  <p>Made with â¤ï¸ by MYGallery</p>
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ Star å§ï¼</p>
</div>
