# âœ… å‘å¸ƒå‰æ£€æŸ¥æ¸…å•

åœ¨ä½¿ç”¨ `bash scripts/release.sh` å‘å¸ƒå‰ï¼Œè¯·ç¡®è®¤ï¼š

## ğŸ“‹ GitHub Secrets é…ç½®

### å¿…é¡»é…ç½®çš„ 2 ä¸ª Secrets

è®¿é—®ï¼š`https://github.com/DanZai233/mygallery/settings/secrets/actions`

#### 1. DOCKER_USERNAME

- **Name**: `DOCKER_USERNAME`
- **Value**: `DanZai233`

#### 2. DOCKER_PASSWORD

- **Name**: `DOCKER_PASSWORD`
- **Value**: Docker Hub è®¿é—®ä»¤ç‰Œï¼ˆä¸æ˜¯å¯†ç ï¼ï¼‰

### å¦‚ä½•è·å– Docker Hub è®¿é—®ä»¤ç‰Œ

```
1. ç™»å½• https://hub.docker.com/
2. ç‚¹å‡»å¤´åƒ â†’ Account Settings
3. Security æ ‡ç­¾
4. ç‚¹å‡» "New Access Token"
5. æè¿°: GitHub Actions
6. æƒé™: Read, Write, Delete
7. ç‚¹å‡» Generate
8. âš ï¸ ç«‹å³å¤åˆ¶ä»¤ç‰Œï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰
```

---

## ğŸ³ Docker Hub ä»“åº“

### ç¡®ä¿ä»“åº“å·²åˆ›å»º

1. è®¿é—®ï¼šhttps://hub.docker.com/
2. ç‚¹å‡» **"Create Repository"**
3. å¡«å†™ä¿¡æ¯ï¼š
   - Name: `mygallery`
   - Visibility: Publicï¼ˆæˆ– Privateï¼‰
4. ç‚¹å‡» **"Create"**

å®Œæ•´åç§°åº”è¯¥æ˜¯ï¼š`DanZai233/mygallery`

---

## ğŸ“ é…ç½®éªŒè¯

### æ£€æŸ¥ workflow é…ç½®

æŸ¥çœ‹ `.github/workflows/docker-publish.yml`ï¼š

```yaml
env:
  IMAGE_NAME: DanZai233/mygallery  # âœ… å·²é…ç½®æ­£ç¡®
```

### æ£€æŸ¥ Secrets

åœ¨ä»“åº“è®¾ç½®ä¸­åº”è¯¥çœ‹åˆ°ï¼š

```
Repository secrets
â”œâ”€ DOCKER_USERNAME (å·²è®¾ç½®)
â””â”€ DOCKER_PASSWORD (å·²è®¾ç½®)
```

---

## ğŸš€ å‘å¸ƒæµç¨‹

### æ–¹å¼ 1: ä½¿ç”¨è‡ªåŠ¨å‘å¸ƒè„šæœ¬

```bash
cd /root/MYGallery

# ç¡®ä¿ä»£ç å·²æäº¤
git add .
git commit -m "feat: æ€§èƒ½ä¼˜åŒ–"
git push origin main

# è¿è¡Œå‘å¸ƒè„šæœ¬
bash scripts/release.sh

# é€‰æ‹©ç‰ˆæœ¬ç±»å‹
# 1 = major (1.0.0 â†’ 2.0.0)
# 2 = minor (1.0.0 â†’ 1.1.0)
# 3 = patch (1.0.0 â†’ 1.0.1)
```

### æ–¹å¼ 2: æ‰‹åŠ¨å‘å¸ƒ

```bash
# 1. åˆ›å»ºæ ‡ç­¾
git tag -a v1.0.1 -m "Release v1.0.1"

# 2. æ¨é€ä»£ç å’Œæ ‡ç­¾
git push origin main
git push origin v1.0.1

# 3. æŸ¥çœ‹ Actions
# https://github.com/DanZai233/mygallery/actions
```

---

## ğŸ‘€ ç›‘æ§æ„å»º

### æŸ¥çœ‹ Actions çŠ¶æ€

è®¿é—®ï¼š`https://github.com/DanZai233/mygallery/actions`

**çŠ¶æ€è¯´æ˜**ï¼š
- ğŸŸ¡ **é»„è‰²åœ†åœˆ** - æ­£åœ¨æ„å»º
- âœ… **ç»¿è‰²å‹¾** - æ„å»ºæˆåŠŸ
- âŒ **çº¢è‰²å‰** - æ„å»ºå¤±è´¥

**æ„å»ºæ—¶é—´**ï¼šçº¦ 5-10 åˆ†é’Ÿ

### æŸ¥çœ‹æ„å»ºæ—¥å¿—

1. ç‚¹å‡» workflow è¿è¡Œè®°å½•
2. ç‚¹å‡» **build-and-push** ä½œä¸š
3. å±•å¼€å„ä¸ªæ­¥éª¤æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

---

## ğŸ¯ æ„å»ºæˆåŠŸå

### éªŒè¯é•œåƒå·²æ¨é€

```bash
# æ‹‰å–é•œåƒ
docker pull DanZai233/mygallery:1.0.1
docker pull DanZai233/mygallery:latest

# æŸ¥çœ‹é•œåƒ
docker images | grep mygallery
```

### ä½¿ç”¨é•œåƒ

```bash
# è¿è¡Œå®¹å™¨
docker run -d \
  --name mygallery \
  -p 8080:8080 \
  -v $(pwd)/config.yaml:/app/config.yaml \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/uploads:/app/uploads \
  DanZai233/mygallery:latest

# è®¿é—®åº”ç”¨
http://localhost:8080
```

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1: Secrets é…ç½®åä»ç„¶å¤±è´¥

**æ£€æŸ¥**ï¼š
1. Secret åç§°æ˜¯å¦å®Œå…¨æ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
   - å¿…é¡»æ˜¯ `DOCKER_USERNAME`ï¼ˆä¸æ˜¯ Docker_Usernameï¼‰
   - å¿…é¡»æ˜¯ `DOCKER_PASSWORD`ï¼ˆä¸æ˜¯ DOCKER_TOKENï¼‰

2. è®¿é—®ä»¤ç‰Œæ˜¯å¦æ­£ç¡®å¤åˆ¶
   - é‡æ–°åˆ›å»ºä»¤ç‰Œ
   - ç¡®ä¿æ²¡æœ‰å¤šä½™ç©ºæ ¼

3. é‡æ–°è¿è¡Œ workflow
   - Actions â†’ é€‰æ‹©å¤±è´¥çš„ workflow
   - ç‚¹å‡» "Re-run all jobs"

### é—®é¢˜ 2: é•œåƒæ¨é€å¤±è´¥

**é”™è¯¯**: `denied: requested access to the resource is denied`

**åŸå› **: ä»“åº“åç§°ä¸åŒ¹é…

**è§£å†³**ï¼š
1. æ£€æŸ¥ Docker Hub ä»“åº“å
2. ç¡®ä¿ workflow ä¸­çš„ IMAGE_NAME æ­£ç¡®
3. æ£€æŸ¥è®¿é—®ä»¤ç‰Œæƒé™

### é—®é¢˜ 3: æ„å»ºè¶…æ—¶

**åŸå› **: ç½‘ç»œé—®é¢˜æˆ–æ„å»ºå¤ªæ…¢

**è§£å†³**ï¼š
- é‡æ–°è¿è¡Œ workflow
- æˆ–ä½¿ç”¨å›½å†…æœåŠ¡å™¨æ„å»º

---

## ğŸ“¸ é…ç½®æˆªå›¾æŒ‡å—

### 1. Docker Hub - åˆ›å»ºè®¿é—®ä»¤ç‰Œ

```
Docker Hub â†’ Settings â†’ Security â†’ New Access Token

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create new access token         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Access Token Description:       â”‚
â”‚ GitHub Actions           [____] â”‚
â”‚                                 â”‚
â”‚ Access permissions:             â”‚
â”‚ [x] Read                        â”‚
â”‚ [x] Write                       â”‚
â”‚ [x] Delete                      â”‚
â”‚                                 â”‚
â”‚        [Generate Token]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âš ï¸ å¤åˆ¶ç”Ÿæˆçš„ä»¤ç‰Œå¹¶ä¿å­˜ï¼
```

### 2. GitHub - æ·»åŠ  Secrets

```
ä»“åº“ â†’ Settings â†’ Secrets and variables â†’ Actions

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ New repository secret           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Name:                           â”‚
â”‚ DOCKER_USERNAME          [____] â”‚
â”‚                                 â”‚
â”‚ Secret:                         â”‚
â”‚ DanZai233               [____] â”‚
â”‚                                 â”‚
â”‚        [Add secret]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é‡å¤æ·»åŠ  DOCKER_PASSWORD
```

---

## ğŸ‰ å®Œæˆåçš„æ•ˆæœ

### GitHub Actions è‡ªåŠ¨åŒ–æµç¨‹

```
æ¨é€ v1.0.1 æ ‡ç­¾
     â†“
è§¦å‘ GitHub Actions
     â†“
æ„å»º Docker é•œåƒ
  â”œâ”€ linux/amd64
  â””â”€ linux/arm64
     â†“
æ¨é€åˆ° Docker Hub
  â”œâ”€ DanZai233/mygallery:1.0.1
  â”œâ”€ DanZai233/mygallery:1.0
  â”œâ”€ DanZai233/mygallery:1
  â””â”€ DanZai233/mygallery:latest
     â†“
âœ… å‘å¸ƒå®Œæˆ
```

### ç”¨æˆ·å¯ä»¥ä½¿ç”¨

```bash
# ä¸€é”®éƒ¨ç½²ä½ çš„ç…§ç‰‡å¢™
docker pull DanZai233/mygallery:latest
docker run -p 8080:8080 DanZai233/mygallery:latest
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæŒ‰ç…§ä»¥ä¸Šæ­¥éª¤ä»ç„¶æ— æ³•è§£å†³ï¼š

1. æˆªå›¾é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥ Actions æ—¥å¿—
3. ç¡®è®¤ Secrets é…ç½®
4. æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

---

**é…ç½®å¥½ Secrets åï¼Œå°±å¯ä»¥æ„‰å¿«åœ°è‡ªåŠ¨å‘å¸ƒäº†ï¼** ğŸš€

